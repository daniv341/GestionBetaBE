generator client {
  provider = "prisma-client-js"
}

// npx prisma generate - genera el cliente prisma, debes usar el comando despues de aplicar una migracion
// npx prisma migrate dev -- name "nombre_de_la_migracion" - realiza la migracion de la base de datos y le pone el nombre que especifiques
// una migracion se refiere a un cambio que le hiciste a la estructura de la base de datos

// provider indica quien es el proveedor de la base de datos o del cliente(dependiendo para que lo uses)
// url indica la url para poder dirigirte a la base de datos, es esencial, sin ella no puede operar la bd

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// id indica que ese parametro sera el id de la tabla
// unique indica que el mismo debe ser unico o no puede repetirse
// default indica como sera dicho parametro por defecto
// autoincrement indica que dicho parametro sera autoincremental
// cuid es para indicar que el id sera un id unico
// ? indica que la relacion es opcional, es decir puede ser nula o opcional mejor dicho
// relation indica que hay una relacion entre 2 tablas

model Producto{
  id                  Int         @id @default(autoincrement())
  nombre              String
  descripcion         String
  precio_venta        Float
  precio_compra       Float
  categoria           String
  SKU                 String      @unique
  stock_actual        Int
  stock_minimo        Int
  enable              Boolean     @default(true)

  //relacion con inventario, indica que la clave foranea (inventarioId) se relacionara con la otra tabla (Inventario) usando como referencia el id de la tabla padra (Inventario)
  inventarioId        Int?        @unique
  inventario          Inventario? @relation(fields: [inventarioId],references: [id])
}

model Usuario{
  uid               String        @id @default(cuid())
  email             String        @unique
  nombre            String        @unique
  contrase√±a        String    
  enable            Boolean       @default(true)
  direccion         String

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}

model UsuarioOAuth {
  uid               String        @id @default(cuid())
  email             String        @unique
  nombre            String?
  foto              String?
  enable            Boolean       @default(true)
  direccion         String?

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}


model Inventario{
  id                Int           @id @default(autoincrement())
  ubicacion         Int

  productos         Producto[]

  //relacion con negocio
  negocioId      Int?             @unique
  negocio        Negocio?         @relation(fields: [negocioId],references: [id])
}

model Negocio{
  id                Int           @id @default(autoincrement())
  logo              String        @unique
  nombre            String
  descripcion       String
  enable            Boolean       @default(true)

  inventario        Inventario?
  usuario           Usuario?
  usuarioOauth      UsuarioOAuth?

  ventas            Venta[]
  proveedores       Proveedor[]
}

model Proveedor{
  id                Int           @id @default(autoincrement())
  empresa           String
  descripcion       String

  compras           Compra[]

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}

model Venta{
  id                Int           @unique @default(autoincrement())
  total             Float
  subtotal          Float
  fecha             DateTime
  carga_impositiva  Float
  ident_factura     Int           @unique
  estado            Boolean       @default(true)
  descuento         Float

  factura           Factura?

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}

model Factura{
  id                Int           @id @default(autoincrement())
  num_comprobante   Int           @unique
  fecha_emision     DateTime
  fecha_vencimiento DateTime

  //relacion con venta
  ventaId           Int?          @unique
  venta             Venta?        @relation(fields: [ventaId],references: [id])
}

model Compra{
  id                Int           @id @default(autoincrement())
  total             Float
  carga_impositiva  Float
  ident_factura     Int           @unique
  estado            Boolean       @default(true)

  //relacion con proveedor
  proveedorId       Int?          @unique
  proveedor         Proveedor?    @relation(fields: [proveedorId],references: [id])
}

