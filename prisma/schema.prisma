generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Producto{
  id                  Int         @id @default(autoincrement())
  nombre              String
  descripcion         String
  precio_venta        Float
  precio_compra       Float
  categoria           String
  SKU                 String      @unique
  stock_actual        Int
  stock_minimo        Int
  enable              Boolean     @default(true)

  //relacion con inventario
  inventarioId        Int?        @unique
  inventario          Inventario? @relation(fields: [inventarioId],references: [id])
}

model Usuario{
  uid               String        @id @default(cuid())
  email             String        @unique
  nombre            String        @unique
  contrase√±a        String    
  enable            Boolean       @default(true)
  direccion         String

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}

model UsuarioOAuth {
  uid               String        @id @default(cuid())
  provider          String?
  providerId        String?
  email             String        @unique
  nombre            String?
  foto              String?
  fechaCreacion     DateTime      @default(now())

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}


model Inventario{
  id                Int           @id @default(autoincrement())
  ubicacion         Int

  productos         Producto[]

  //relacion con negocio
  negocioId      Int?             @unique
  negocio        Negocio?         @relation(fields: [negocioId],references: [id])
}

model Negocio{
  id                Int           @id @default(autoincrement())
  logo              String        @unique
  nombre            String
  descripcion       String
  enable            Boolean       @default(true)

  inventario        Inventario?
  usuario           Usuario?
  usuarioOauth      UsuarioOAuth?

  ventas            Venta[]
  proveedores       Proveedor[]
}

model Proveedor{
  id                Int           @id @default(autoincrement())
  empresa           String
  descripcion       String

  compras           Compra[]

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}

model Venta{
  id                Int           @unique @default(autoincrement())
  total             Float
  subtotal          Float
  fecha             DateTime
  carga_impositiva  Float
  ident_factura     Int           @unique
  estado            Boolean       @default(true)
  descuento         Float

  factura           Factura?

  //relacion con negocio
  negocioId         Int?          @unique
  negocio           Negocio?      @relation(fields: [negocioId],references: [id])
}

model Factura{
  id                Int           @id @default(autoincrement())
  num_comprobante   Int           @unique
  fecha_emision     DateTime
  fecha_vencimiento DateTime

  //relacion con venta
  ventaId           Int?          @unique
  venta             Venta?        @relation(fields: [ventaId],references: [id])
}

model Compra{
  id                Int           @id @default(autoincrement())
  total             Float
  carga_impositiva  Float
  ident_factura     Int           @unique
  estado            Boolean       @default(true)

  //relacion con proveedor
  proveedorId       Int?          @unique
  proveedor         Proveedor?    @relation(fields: [proveedorId],references: [id])
}

